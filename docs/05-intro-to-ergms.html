<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.298">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Statistical Inference in Network Science - 6&nbsp; Introduction to ERGMs</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./06-ergms-cont.html" rel="next">
<link href="./04-lab-1.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-YCY24Z74EY"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-YCY24Z74EY', { 'anonymize_ip': true});
</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Statistical Inference in Network Science</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/gvegayon/networks-udd2024" rel="" target=""><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="./Statistical-Inference-in-Network-Science.epub">
              <i class="bi bi-bi-journal pe-1"></i>
            Download ePub
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="./Statistical-Inference-in-Network-Science.pdf">
              <i class="bi bi-bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
      </ul>
    </div>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01-overview.html">Day 1</a></li><li class="breadcrumb-item"><a href="./05-intro-to-ergms.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Introduction to ERGMs</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Home</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Day 1</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Overview</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-random-graphs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Random graphs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-behavior-and-coevolution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Behavior and coevolution</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-lab-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Lab 1</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-intro-to-ergms.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Introduction to ERGMs</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Day 2</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-ergms-cont.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Convergence on ERGMs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-odd-balls.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Odd balls</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-lab-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Lab II</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-advanced-ergms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Advanced ERGMs: Constraints</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-new-topics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">New topics in network modeling</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">6.1</span> Introduction</a></li>
  <li><a href="#dyadic-independence-p1" id="toc-dyadic-independence-p1" class="nav-link" data-scroll-target="#dyadic-independence-p1"><span class="header-section-number">6.2</span> Dyadic independence (p1)</a></li>
  <li><a href="#the-most-important-results" id="toc-the-most-important-results" class="nav-link" data-scroll-target="#the-most-important-results"><span class="header-section-number">6.3</span> The most important results</a></li>
  <li><a href="#the-logistic-distribution" id="toc-the-logistic-distribution" class="nav-link" data-scroll-target="#the-logistic-distribution"><span class="header-section-number">6.4</span> The logistic distribution</a></li>
  <li><a href="#the-ratio-of-loglikelihoods" id="toc-the-ratio-of-loglikelihoods" class="nav-link" data-scroll-target="#the-ratio-of-loglikelihoods"><span class="header-section-number">6.5</span> The ratio of loglikelihoods</a></li>
  <li><a href="#start-to-finish-example" id="toc-start-to-finish-example" class="nav-link" data-scroll-target="#start-to-finish-example"><span class="header-section-number">6.6</span> Start to finish example</a></li>
  <li><a href="#inspect-the-data" id="toc-inspect-the-data" class="nav-link" data-scroll-target="#inspect-the-data"><span class="header-section-number">6.7</span> Inspect the data</a></li>
  <li><a href="#start-with-endogenous-effects-first" id="toc-start-with-endogenous-effects-first" class="nav-link" data-scroll-target="#start-with-endogenous-effects-first"><span class="header-section-number">6.8</span> Start with endogenous effects first</a></li>
  <li><a href="#lets-add-a-little-bit-of-structure" id="toc-lets-add-a-little-bit-of-structure" class="nav-link" data-scroll-target="#lets-add-a-little-bit-of-structure"><span class="header-section-number">6.9</span> Let’s add a little bit of structure</a></li>
  <li><a href="#more-about-ergms" id="toc-more-about-ergms" class="nav-link" data-scroll-target="#more-about-ergms"><span class="header-section-number">6.10</span> More about ERGMs</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Introduction to ERGMs</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Have you ever wondered if the friend of your friend is your friend? Or if the people you consider to be your friends feel the same about you? Or if age is related to whether you seek advice from others? All these (and many others certainly more creative) questions can be answered using Exponential-Family Random Graph Models.</p>
<section id="introduction" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">6.1</span> Introduction</h2>
<p>Exponential-Family Random Graph Models, known as ERGMs, ERG Models, or <span class="math inline">p^*</span> models (<span class="citation" data-cites="Holland1981">Holland and Leinhardt (<a href="references.html#ref-Holland1981" role="doc-biblioref">1981</a>)</span>, <span class="citation" data-cites="Frank1986">Frank and Strauss (<a href="references.html#ref-Frank1986" role="doc-biblioref">1986</a>)</span>, <span class="citation" data-cites="Wasserman1996">Wasserman and Pattison (<a href="references.html#ref-Wasserman1996" role="doc-biblioref">1996</a>)</span>, <span class="citation" data-cites="Snijders2006">Snijders et al. (<a href="references.html#ref-Snijders2006" role="doc-biblioref">2006</a>)</span>, <span class="citation" data-cites="Robins2007">Robins et al. (<a href="references.html#ref-Robins2007" role="doc-biblioref">2007</a>)</span>, and many others) are a large family of statistical distributions for random graphs. In ERGMs, the focus is on the processes that give origin to the network rather than the individual ties.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>The most common representation of ERGMs is the following:</p>
<p><span class="math display">
P_{\mathcal{Y}, \bm{{\theta}}}(\bm{{Y}}=\bm{{y}}) =  \exp\left(\bm{{\theta}}^{\mathbf{t}} s(y)\right)\kappa(\bm{{\theta}})^{-1}
</span></p>
<p>where <span class="math inline">\bm{{Y}}</span> is a random graph, <span class="math inline">\bm{{y}}\in \mathcal{Y}</span> is a particular realization of <span class="math inline">Y</span>, <span class="math inline">\bm{{\theta}}</span> is a vector of parameters, <span class="math inline">s(\bm{{y}})</span> is a vector of sufficient statistics, and <span class="math inline">\kappa(\bm{{\theta}})</span> is a normalizing constant. The normalizing constant is defined as:</p>
<p><span class="math display">
\kappa(\bm{{\theta}}) = \sum_{\bm{{y}} \in \mathcal{Y}} \exp\left(\bm{{\theta}}^{\mathbf{t}} s(\bm{{y}})\right)
</span></p>
<p>From the statistical point of view, the normalizing constant makes this model attractive; only cases where <span class="math inline">\mathcal{Y}</span> is small enough to be enumerated are feasible <span class="citation" data-cites="vegayonExponentialRandomGraph2021">(<a href="references.html#ref-vegayonExponentialRandomGraph2021" role="doc-biblioref">Vega Yon, Slaughter, and Haye 2021</a>)</span>. Because of that reason, estimating ERGMs is a challenging task.</p>
<p>In more simple terms, ERG models resemble Logistic regressions. The term <span class="math inline">\bm{{\theta}}^{\mathbf{t}} s(\bm{{y}})</span> is simply the sum of the product between the parameters and the statistics (like you would see in a Logistic regression,) and its key component is the composition of the vector of sufficient statistics, <span class="math inline">s(\bm{{y}})</span>. The latter is what defines the model.</p>
<p>The vector of sufficient statistics dictates the data-generating process of the network. Like the mean and variance characterize the normal distribution, sufficient statistics (and corresponding parameters) characterize the ERG distribution. <a href="#fig-ergmterms">Figure&nbsp;<span>6.1</span></a> shows some examples of sufficient statistics with their corresponding parametrizations.</p>
<div id="fig-ergmterms" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figs/ergm-terms-vegayonetal2021.jpg" class="img-fluid figure-img" style="width:60.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;6.1: Example ERGM terms from <span class="citation" data-cites="vegayonExponentialRandomGraph2021">Vega Yon, Slaughter, and Haye (<a href="references.html#ref-vegayonExponentialRandomGraph2021" role="doc-biblioref">2021</a>)</span></figcaption><p></p>
</figure>
</div>
<p>The <code>ergm</code> package has many terms we can use to fit these models. You can explore the available terms in the manual <code>ergm.terms</code> in the <code>ergm</code> package. Take a moment to explore the manual and see the different terms available.</p>
</section>
<section id="dyadic-independence-p1" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="dyadic-independence-p1"><span class="header-section-number">6.2</span> Dyadic independence (p1)</h2>
<p>The simplest ERG model we can fit is a Bernoulli (Erdos-Renyi) model. Here, the only statistic is the edgecount. Now, if we can write the function computing sufficient statistics as a sum over all edges, <em>i.e.</em>, <span class="math inline">s(\bm{{y}}) = \sum_{ij}s'(y_{ij})</span>, the model reduces to a Logistic regression.</p>
<div class="cell" data-hash="05-intro-to-ergms_cache/html/bernoulli-ergm_93e3effd5fad2466224c7a8a98938121">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ergm)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulating a Bernoulli network</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">100</span><span class="sc">^</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="fl">0.1</span>), <span class="dv">100</span>, <span class="dv">100</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(Y) <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">logit =</span> <span class="fu">glm</span>(<span class="fu">as.vector</span>(Y) <span class="sc">~</span> <span class="dv">1</span>, <span class="at">family =</span> binomial) <span class="sc">|&gt;</span> <span class="fu">coef</span>(),</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">ergm  =</span> <span class="fu">ergm</span>(Y <span class="sc">~</span> edges) <span class="sc">|&gt;</span> <span class="fu">coef</span>(),</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">avg   =</span> <span class="fu">mean</span>(Y, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> <span class="fu">qlogis</span>()</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="do">##                 logit      ergm       avg</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept) -2.170574 -2.170574 -2.170574</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>When we see this, we say that dyads are independent of each other; this is also called <em>p1</em> models <span class="citation" data-cites="Holland1981">(<a href="references.html#ref-Holland1981" role="doc-biblioref">Holland and Leinhardt 1981</a>)</span>. As a second example, imagine that we are interested in assessing whether gender homophily (the tendency between individuals of the same gender to connect) is present in a network. ERG models are the right tool for this task. Moreover, if we assume that gender homophily is the only mechanism that governs the network, the problem reduces to a Logistic regression:</p>
<p><span class="math display">
P_{\mathcal{Y}, \bm{{\theta}}}(y_{ij} = 1) = \text{Logit}^{-1}\left(\theta_{edges} + \theta_{homophily}\mathbb{1}\left(X_i = X_j\right)\right)
</span></p>
<p>where <span class="math inline">\mathbb{1}\left(\cdot\right)</span> is the indicator function, and <span class="math inline">X_i</span> equals one if the <span class="math inline">ith</span> individual is female, and zero otherwise. To see this, let’s simulate some data. We will use the <code>simulate_formula</code> function in the <code>ergm</code> package. All we need is a network, a model, and some arbitrary coefficients. We start with an indicator vector for gender (1: female, male otherwise):</p>
<div class="cell" data-hash="05-intro-to-ergms_cache/html/simple-example_a6b02adcfab5678b7567b11746d68f08">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulating data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7731</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">100</span>, <span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0 1 0 0 1 0</code></pre>
</div>
</div>
<p>Next, we use the functions from the <code>ergm</code> and <code>network</code> packages to simulate a network with homophily:</p>
<div class="cell" data-hash="05-intro-to-ergms_cache/html/simple-example-simulate_49e1ddfe94afb8bb755ab151ed32c771">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulating the network with homophily</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ergm)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="do">## A network with 100 vertices</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">network</span>(<span class="dv">100</span>) </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Adding the vertex attribute with the %v% operator</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>Y <span class="sc">%v%</span> <span class="st">"X"</span> <span class="ot">&lt;-</span> X</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulating the network</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> ergm<span class="sc">::</span><span class="fu">simulate_formula</span>(</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The model</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  Y <span class="sc">~</span> edges <span class="sc">+</span> <span class="fu">nodematch</span>(<span class="st">"X"</span>),</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The coefficients</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">coef =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In this case, the network tends to be sparse (negative edges coefficient) and present homophilic ties (positive nodematch coefficient). Using the <code>sna</code> package (also from the <code>statnet</code> suite), we can plot the network:</p>
<div class="cell" data-hash="05-intro-to-ergms_cache/html/simple-example-plot_109c7f6b8bfa5da79cb0963533224841">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sna)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gplot</span>(Y, <span class="at">vertex.col =</span> <span class="fu">c</span>(<span class="st">"green"</span>, <span class="st">"red"</span>)[Y <span class="sc">%v%</span> <span class="st">"X"</span> <span class="sc">+</span> <span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05-intro-to-ergms_files/figure-html/simple-example-plot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Using the ERGM package, we can fit the model using code very similar to the one used to simulate the network:</p>
<div class="cell" data-hash="05-intro-to-ergms_cache/html/simple-example-fit_8e204b37b7d5bf05464f829835ca896e">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>fit_homophily <span class="ot">&lt;-</span> <span class="fu">ergm</span>(Y <span class="sc">~</span> edges <span class="sc">+</span> <span class="fu">nodematch</span>(<span class="st">"X"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will check the results later and compare them against the following: the Logit model. The following code chunk implements the logistic regression model for this particular model. This example only proves that ERGMs are a generalization of Logistic regression.</p>
<div class="callout callout-style-simple callout-none no-icon callout-titled" title="Only to learn!">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Only to learn!
</div>
</div>
<div class="callout-body-container callout-body">
<p>This example was created only for learning purposes. In practice, you should <strong>always</strong> use the <code>ergm</code> package or <code>PNet</code> software to fit ERGMs.</p>
</div>
</div>
<div class="cell" data-hash="05-intro-to-ergms_cache/html/simple-example-logit-definition_5b24013f2c329515f3147ee1bc8ddd28">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>sstats <span class="ot">&lt;-</span> <span class="fu">summary_formula</span>(Y <span class="sc">~</span> edges <span class="sc">+</span> <span class="fu">nodematch</span>(<span class="st">"X"</span>))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>Y_mat <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(Y)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(Y_mat) <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="do">## To speedup computations, we pre-compute this value</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>X_vec <span class="ot">&lt;-</span> <span class="fu">outer</span>(X, X, <span class="st">"=="</span>) <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Function to compute the negative loglikelihood</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>obj <span class="ot">&lt;-</span> \(theta) {</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute the probability according to the value of Y</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    Y_mat <span class="sc">==</span> <span class="dv">1</span>,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If Y = 1</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plogis</span>(theta[<span class="dv">1</span>] <span class="sc">+</span> X_vec <span class="sc">*</span> theta[<span class="dv">2</span>]),</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If Y = 0</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span> <span class="sc">-</span> <span class="fu">plogis</span>(theta[<span class="dv">1</span>] <span class="sc">+</span> X_vec <span class="sc">*</span> theta[<span class="dv">2</span>])</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The -loglikelihood</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span><span class="fu">sum</span>(<span class="fu">log</span>(p[<span class="sc">!</span><span class="fu">is.na</span>(p)]))</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>And, using the <code>optim</code> function, we can fit the model:</p>
<div class="cell" data-hash="05-intro-to-ergms_cache/html/simple-example-logit-fit_670d559b7172905eb58747c1f6f049b7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Fitting the model</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>fit_homophily_logit <span class="ot">&lt;-</span> <span class="fu">optim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), obj, <span class="at">hessian =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now that we have the values let’s compare them:</p>
<div class="cell" data-hash="05-intro-to-ergms_cache/html/simple-example-fit-glm-coef_6e6408ee95369ef0b0d89845878ab33d">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="do">## The coefficients</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">theta_ergm  =</span> <span class="fu">coef</span>(fit_homophily),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">theta_logit =</span> fit_homophily_logit<span class="sc">$</span>par,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">sd_ergm     =</span> <span class="fu">vcov</span>(fit_homophily) <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sqrt</span>(),</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">sd_logit    =</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">solve</span>(fit_homophily_logit<span class="sc">$</span>hessian)))</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            theta_ergm theta_logit    sd_ergm   sd_logit
edges        -2.973331   -2.973829 0.06659648 0.06661194
nodematch.X   1.926039    1.926380 0.07395580 0.07397025</code></pre>
</div>
</div>
<p>As you can see, both models yielded the same estimates because they are the same! Before continuing, let’s review a couple of important results in ERGMs.</p>
</section>
<section id="the-most-important-results" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="the-most-important-results"><span class="header-section-number">6.3</span> The most important results</h2>
<p>If we were able to say what two of the most important results in ERGMs are, I would say the following: (a) conditioning on the rest of the graph, the probability of a tie distributes Logistic (Bernoulli), and (b) the ratio between two loglikelihoods can be approximated through simulation.</p>
</section>
<section id="the-logistic-distribution" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="the-logistic-distribution"><span class="header-section-number">6.4</span> The logistic distribution</h2>
<p>Let’s start by stating the result: Conditioning on all graphs that are not <span class="math inline">y_{ij}</span>, the probability of a tie <span class="math inline">Y_{ij}</span> is distributed Logistic; formally:</p>
<p><span class="math display">
P_{\mathcal{Y}, \bm{{\theta}}}(Y_{ij}=1 | \bm{{y}}_{-ij}) = \frac{1}{1 + \exp \left(\bm{{\theta}}^{\mathbf{t}}\delta_{ij}(\bm{{y}}){}\right)},
</span></p>
<p>where <span class="math inline">\delta_{ij}(\bm{{y}}){}\equiv s_{ij}^+(\bm{{y}}) - s_{ij}^-(\bm{{y}})</span> is the change statistic, and <span class="math inline">s_{ij}^+(\bm{{y}})</span> and <span class="math inline">s_{ij}^-(\bm{{y}})</span> are the statistics of the graph with and without the tie <span class="math inline">Y_{ij}</span>, respectively.</p>
<p>The importance of this result is two-fold: (a) we can use this equation to interpret fitted models in the context of a single graph (like using odds,) and (b) we can use this equation to simulate from the model, <strong>without touching the normalizing constant</strong>.</p>
</section>
<section id="the-ratio-of-loglikelihoods" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="the-ratio-of-loglikelihoods"><span class="header-section-number">6.5</span> The ratio of loglikelihoods</h2>
<p>The second significant result is that the ratio of loglikelihoods can be approximated through simulation. It is based on the following observation by <span class="citation" data-cites="geyerConstrainedMonteCarlo1992">Geyer and Thompson (<a href="references.html#ref-geyerConstrainedMonteCarlo1992" role="doc-biblioref">1992</a>)</span>:</p>
<p><span class="math display">
\frac{\kappa(\bm{{\theta}})}{\kappa(\bm{{\theta}}_0)} = \mathbb{E}_{\mathcal{Y}, \bm{{\theta}}_0}\left((\bm{{\theta}} - \bm{{\theta}}_0)s(\bm{{y}})^{\mathbf{t}}\right),
</span></p>
<p>Using the latter, we can approximate the following loglikelihood ratio:</p>
<p><span class="math display">\begin{align*}
l(\bm{{\theta}}) - l(\bm{{\theta}}_0) = &amp; (\bm{{\theta}} - \bm{{\theta}}_0)^{\mathbf{t}}s(\bm{{y}}) - \log\left[\frac{\kappa(\bm{{\theta}})}{\kappa(\bm{{\theta}}_0)}\right]\\
\approx &amp; (\bm{{\theta}} - \bm{{\theta}}_0)^{\mathbf{t}}s(\bm{{y}}) - \log\left[M^{-1}\sum_{\bm{{y}}^{(m)}} (\bm{{\theta}} - \bm{{\theta}}_0)^{\mathbf{t}}s(\bm{{y}}^{(m)})\right]
\end{align*}</span></p>
<p>Where <span class="math inline">\bm{{\theta}}_0</span> is an arbitrary vector of parameters, and <span class="math inline">\bm{{y}}^{(m)}</span> are sampled from the distribution <span class="math inline">P_{\mathcal{Y}, \bm{{\theta}}_0}</span>. In the words of <span class="citation" data-cites="geyerConstrainedMonteCarlo1992">Geyer and Thompson (<a href="references.html#ref-geyerConstrainedMonteCarlo1992" role="doc-biblioref">1992</a>)</span>, “[…] it is possible to approximate <span class="math inline">\bm{{\theta}}</span> by using simulations from one distribution <span class="math inline">P_{\mathcal{Y}, \bm{{\theta}}_0}</span> no matter which <span class="math inline">\bm{{\theta}}_0</span> in the parameter space is.”</p>
</section>
<section id="start-to-finish-example" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="start-to-finish-example"><span class="header-section-number">6.6</span> Start to finish example</h2>
<p>There is no silver bullet to fit ERGMs. However, the following steps are a good starting point:</p>
<ol type="1">
<li><p><strong>Inspect the data</strong>: Ensure the network you work with is processed correctly. Some common mistakes include isolates being excluded, vertex attributes not being adequately aligned (mismatch), etc.</p></li>
<li><p><strong>Start with endogenous effects first</strong>: Before jumping into vertex/edge-covariates, try fitting models that only include structural terms such as edgecount, triangles (or their equivalent,) stars, reciprocity, etc.</p></li>
<li><p><strong>After structure is controlled</strong>: You can add vertex/edge-covariates. The most common ones are homophily, nodal-activity, etc.</p></li>
<li><p><strong>Evaluate your results</strong>: Once you have a model you are happy with, the last couple of steps are (a) assess convergence (which is usually done automagically by the <code>ergm</code> package,) and (b) assess goodness-of-fit, which in this context means how good was our model to capture (not-controlled for) properties of the network.</p></li>
</ol>
<p>Although we could go ahead and use an existing dataset to play with, instead, we will simulate a directed graph with the following properties:</p>
<ul>
<li>100 nodes.</li>
<li>Homophily on Music taste.</li>
<li>Gender heterophily.</li>
<li>Reciprocity</li>
</ul>
<p>The following code chunk illustrates how to do this in R. Notice that, like the previous example, we need to create a network with the vertex attributes needed to simulate homophily.</p>
<div class="cell" data-hash="05-intro-to-ergms_cache/html/generating-data_c80ed46ef95f9e68ff1a15205c5385ef">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulating the covariates (vertex attribute)</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1235</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulating the data</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">network</span>(<span class="dv">100</span>, <span class="at">directed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>Y <span class="sc">%v%</span> <span class="st">"fav_music"</span> <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"rock"</span>, <span class="st">"jazz"</span>, <span class="st">"pop"</span>), <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>Y <span class="sc">%v%</span> <span class="st">"female"</span>    <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">100</span>, <span class="dv">1</span>, <span class="fl">0.5</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now that we have a starting point for the simulation, we can use the <code>simulate_formula</code> function to get our network:</p>
<div class="cell" data-hash="05-intro-to-ergms_cache/html/generating-data-simulate_ee7c777f1f0a052840787edafef90152">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> ergm<span class="sc">::</span><span class="fu">simulate_formula</span>(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  Y <span class="sc">~</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    edges <span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">nodematch</span>(<span class="st">"fav_music"</span>) <span class="sc">+</span> </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">nodematch</span>(<span class="st">"female"</span>) <span class="sc">+</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    mutual,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">coef =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="do">## And visualize it!</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="fu">gplot</span>(Y, <span class="at">vertex.col =</span> <span class="fu">c</span>(<span class="st">"green"</span>, <span class="st">"red"</span>)[Y <span class="sc">%v%</span> <span class="st">"female"</span> <span class="sc">+</span> <span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05-intro-to-ergms_files/figure-html/generating-data-simulate-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This figure is precisely why we need ERGMs (and why many Sunbelt talks don’t include a network visualization!). We know the graph has structure (it’s not random), but visually, it is hard to see.</p>
</section>
<section id="inspect-the-data" class="level2" data-number="6.7">
<h2 data-number="6.7" class="anchored" data-anchor-id="inspect-the-data"><span class="header-section-number">6.7</span> Inspect the data</h2>
<p>For the sake of time, we will not take the time to investigate our network properly. However, you should always do so. Make sure you do descriptive statistics (density, centrality, modularity, etc.), check missing values, isolates (disconnected nodes), and inspect your data visually through “notepad” and visualizations before jumping into your ERG model.</p>
</section>
<section id="start-with-endogenous-effects-first" class="level2" data-number="6.8">
<h2 data-number="6.8" class="anchored" data-anchor-id="start-with-endogenous-effects-first"><span class="header-section-number">6.8</span> Start with endogenous effects first</h2>
<p>The step is to check whether we can fit an ERGM or not. We can do so with the Bernoulli graph:</p>
<div class="cell" data-hash="05-intro-to-ergms_cache/html/first-model_4cc0eda43d36dcc503989683aca50a67">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>model_1 <span class="ot">&lt;-</span> <span class="fu">ergm</span>(Y <span class="sc">~</span> edges)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
ergm(formula = Y ~ edges)

Maximum Likelihood Results:

      Estimate Std. Error MCMC % z value Pr(&gt;|z|)    
edges -3.78885    0.06833      0  -55.45   &lt;1e-04 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

     Null Deviance: 13724  on 9900  degrees of freedom
 Residual Deviance:  2102  on 9899  degrees of freedom
 
AIC: 2104  BIC: 2112  (Smaller is better. MC Std. Err. = 0)</code></pre>
</div>
</div>
<p>It is rare to see a model in which the edgecount is not significant. The next term we will add is reciprocity (<code>mutual</code> in the <code>ergm</code> package)</p>
<div class="cell" data-hash="05-intro-to-ergms_cache/html/model-mutual_cc9876ec0f49217874be7a68a193d60f">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>model_2 <span class="ot">&lt;-</span> <span class="fu">ergm</span>(Y <span class="sc">~</span> edges <span class="sc">+</span> mutual) </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_2)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="do">## ergm(formula = Y ~ edges + mutual)</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Monte Carlo Maximum Likelihood Results:</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="do">##        Estimate Std. Error MCMC % z value Pr(&gt;|z|)    </span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="do">## edges  -3.93277    0.07833      0 -50.205   &lt;1e-04 ***</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="do">## mutual  2.15152    0.31514      0   6.827   &lt;1e-04 ***</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="do">##      Null Deviance: 13724  on 9900  degrees of freedom</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="do">##  Residual Deviance:  2064  on 9898  degrees of freedom</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="do">##  </span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="do">## AIC: 2068  BIC: 2083  (Smaller is better. MC Std. Err. = 0.8083)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As expected, reciprocity is significant (we made it like this!.) Notwithstanding, there is a difference between this model and the previous one. This model was not fitted using MLE. Instead, since the reciprocity term involves more than one tie, the model cannot be reduced to a Logistic regression, so it needs to be estimated using one of the other available estimation methods in the <code>ergm</code> package.</p>
<p>The model starts gaining complexity as we add higher-order terms involving more ties. An infamous example is the number of triangles. Although highly important for social sciences, including triangle terms in your ERGMs results in a degenerate model (when the MCMC chain jumps between empty and fully connected graphs). One exception is if you deal with small networks. To address this, <span class="citation" data-cites="Snijders2006">Snijders et al. (<a href="references.html#ref-Snijders2006" role="doc-biblioref">2006</a>)</span> and <span class="citation" data-cites="hunterCurvedExponentialFamily2007">Hunter (<a href="references.html#ref-hunterCurvedExponentialFamily2007" role="doc-biblioref">2007</a>)</span> introduced various new terms that significantly reduce the risk of degeneracy. Here, we will illustrate the use of the term “geometrically weighted dyadic shared partner” (<code>gwdsp</code>,) which Prof.&nbsp;David Hunter proposed. The <code>gwdsp</code> term is akin to triadic closure but reduces the chances of degeneracy.</p>
<div class="cell" data-hash="05-intro-to-ergms_cache/html/model-gwdsp_8329c2c4aa8548e38e668515588e1bd2">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Fitting two more models (output message suppressed)</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>model_3 <span class="ot">&lt;-</span> <span class="fu">ergm</span>(Y <span class="sc">~</span> edges <span class="sc">+</span> mutual <span class="sc">+</span> <span class="fu">gwdsp</span>(.<span class="dv">5</span>, <span class="at">fixed =</span> <span class="cn">TRUE</span>))</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="do">## model_4 &lt;- ergm(Y ~ edges + triangles) # bad idea</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Right after fitting a model, we want to inspect the results. An excellent tool for this is the R package <code>texreg</code> <span class="citation" data-cites="leifeldTexregConversionStatistical2013">(<a href="references.html#ref-leifeldTexregConversionStatistical2013" role="doc-biblioref">Leifeld 2013</a>)</span>:</p>
<div class="cell" data-hash="05-intro-to-ergms_cache/html/simples-table_2a5e208eee599143ab4d962ff2095feb">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(texreg)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">screenreg</span>(<span class="fu">list</span>(model_1, model_2, model_3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=============================================================
                     Model 1       Model 2       Model 3     
-------------------------------------------------------------
edges                   -3.79 ***     -3.93 ***     -3.84 ***
                        (0.07)        (0.08)        (0.21)   
mutual                                 2.15 ***      2.14 ***
                                      (0.32)        (0.29)   
gwdsp.OTP.fixed.0.5                                 -0.02    
                                                    (0.05)   
-------------------------------------------------------------
AIC                   2104.43       2068.22       2071.94    
BIC                   2111.63       2082.62       2093.54    
Log Likelihood       -1051.22      -1032.11      -1032.97    
=============================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
<p>So far, <code>model_2</code> is winning. We will continue with this model.</p>
</section>
<section id="lets-add-a-little-bit-of-structure" class="level2" data-number="6.9">
<h2 data-number="6.9" class="anchored" data-anchor-id="lets-add-a-little-bit-of-structure"><span class="header-section-number">6.9</span> Let’s add a little bit of structure</h2>
<p>Now that we only have a model featuring endogenous terms, we can add vertex/edge-covariates. Starting with <code>"fav_music"</code>, there are a couple of different ways to use this node feature:</p>
<ol type="a">
<li><p>Directly through homophily (assortative mixing): Using the <code>nodematch</code> term, we can control for the propensity of individuals to connect based on shared music taste.</p></li>
<li><p>Homophily (v2): We could activate the option <code>diff = TRUE</code> using the same term. By doing this, the homophily term is operationalized differently, adding as many terms as options in the vertex attribute.</p></li>
<li><p>Mixing: We can use the term <code>nodemix</code> for individuals’ tendency to mix between musical tastes.</p></li>
</ol>
<div class="callout callout-style-simple callout-none no-icon callout-titled" title="Question">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question
</div>
</div>
<div class="callout-body-container callout-body">
<p>In this context, what would be the different hypotheses behind each decision?</p>
</div>
</div>
<div class="cell" data-hash="05-intro-to-ergms_cache/html/working-homophily_cda776e597fcbddc9203195b2a7a38df">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>model_4 <span class="ot">&lt;-</span> <span class="fu">ergm</span>(Y <span class="sc">~</span> edges <span class="sc">+</span> mutual <span class="sc">+</span> <span class="fu">nodematch</span>(<span class="st">"fav_music"</span>))</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>model_5 <span class="ot">&lt;-</span> <span class="fu">ergm</span>(Y <span class="sc">~</span> edges <span class="sc">+</span> mutual <span class="sc">+</span> <span class="fu">nodematch</span>(<span class="st">"fav_music"</span>, <span class="at">diff =</span> <span class="cn">TRUE</span>))</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>model_6 <span class="ot">&lt;-</span> <span class="fu">ergm</span>(Y <span class="sc">~</span> edges <span class="sc">+</span> mutual <span class="sc">+</span> <span class="fu">nodemix</span>(<span class="st">"fav_music"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, let’s inspect what we have so far:</p>
<div class="cell" data-hash="05-intro-to-ergms_cache/html/working-homophily-table_3d064a7a910fa6ccf1f77674ce8bb628">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">screenreg</span>(<span class="fu">list</span>(<span class="st">`</span><span class="at">2</span><span class="st">`</span> <span class="ot">=</span> model_2, <span class="st">`</span><span class="at">4</span><span class="st">`</span> <span class="ot">=</span> model_4, <span class="st">`</span><span class="at">5</span><span class="st">`</span> <span class="ot">=</span> model_5, <span class="st">`</span><span class="at">6</span><span class="st">`</span> <span class="ot">=</span> model_6))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
================================================================================
                          2             4             5             6           
--------------------------------------------------------------------------------
edges                        -3.93 ***     -4.29 ***     -4.29 ***     -3.56 ***
                             (0.08)        (0.11)        (0.11)        (0.24)   
mutual                        2.15 ***      1.99 ***      2.00 ***      2.02 ***
                             (0.32)        (0.30)        (0.30)        (0.30)   
nodematch.fav_music                         0.85 ***                            
                                           (0.14)                               
nodematch.fav_music.jazz                                  0.74 **               
                                                         (0.25)                 
nodematch.fav_music.pop                                   0.82 ***              
                                                         (0.18)                 
nodematch.fav_music.rock                                  0.87 ***              
                                                         (0.17)                 
mix.fav_music.pop.jazz                                                 -0.54    
                                                                       (0.34)   
mix.fav_music.rock.jazz                                                -0.75 *  
                                                                       (0.38)   
mix.fav_music.jazz.pop                                                 -0.60    
                                                                       (0.35)   
mix.fav_music.pop.pop                                                   0.10    
                                                                       (0.27)   
mix.fav_music.rock.pop                                                 -0.50    
                                                                       (0.31)   
mix.fav_music.jazz.rock                                                -1.40 ** 
                                                                       (0.44)   
mix.fav_music.pop.rock                                                 -0.86 *  
                                                                       (0.33)   
mix.fav_music.rock.rock                                                 0.15    
                                                                       (0.27)   
--------------------------------------------------------------------------------
AIC                        2068.22       2030.85       2033.57       2036.37    
BIC                        2082.62       2052.45       2069.57       2108.38    
Log Likelihood            -1032.11      -1012.42      -1011.79      -1008.19    
================================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
<p>Although model 5 has a higher loglikelihood, using AIC or BIC suggests model 4 is a better candidate. For the sake of time, we will jump ahead and add <code>nodematch("female")</code> as the last term of our model. The next step is to assess (a) convergence and (b) goodness-of-fit.</p>
<div class="cell" data-hash="05-intro-to-ergms_cache/html/last-model_8fa9619213093500550ff6a5d754a41c">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>model_final <span class="ot">&lt;-</span> <span class="fu">ergm</span>(Y <span class="sc">~</span> edges <span class="sc">+</span> mutual <span class="sc">+</span> <span class="fu">nodematch</span>(<span class="st">"fav_music"</span>) <span class="sc">+</span> <span class="fu">nodematch</span>(<span class="st">"female"</span>))</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Printing the pretty table</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">screenreg</span>(<span class="fu">list</span>(<span class="st">`</span><span class="at">2</span><span class="st">`</span> <span class="ot">=</span> model_2, <span class="st">`</span><span class="at">4</span><span class="st">`</span> <span class="ot">=</span> model_4, <span class="st">`</span><span class="at">Final</span><span class="st">`</span> <span class="ot">=</span> model_final))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
============================================================
                     2             4             Final      
------------------------------------------------------------
edges                   -3.93 ***     -4.29 ***    -3.95 ***
                        (0.08)        (0.11)       (0.12)   
mutual                   2.15 ***      1.99 ***     1.86 ***
                        (0.32)        (0.30)       (0.33)   
nodematch.fav_music                    0.85 ***     0.81 ***
                                      (0.14)       (0.14)   
nodematch.female                                   -0.74 ***
                                                   (0.15)   
------------------------------------------------------------
AIC                   2068.22       2030.85      2002.18    
BIC                   2082.62       2052.45      2030.98    
Log Likelihood       -1032.11      -1012.42      -997.09    
============================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</section>
<section id="more-about-ergms" class="level2" data-number="6.10">
<h2 data-number="6.10" class="anchored" data-anchor-id="more-about-ergms"><span class="header-section-number">6.10</span> More about ERGMs</h2>
<p>We have shown here just a glimpse of what ERG models are. A large, active, collaborative community of social network scientists is working on new extensions and advances. If you want to learn more about ERGMs, I recommend the following resources:</p>
<ul>
<li><p>The Statnet website <a href="https://statnet.org/">(link)</a>.</p></li>
<li><p>The book “Exponential Random Graph Models for Social Networks: Theory, Methods, and Applications” by <span class="citation" data-cites="lusherExponentialRandomGraph2013">Lusher, Koskinen, and Robins (<a href="references.html#ref-lusherExponentialRandomGraph2013" role="doc-biblioref">2013</a>)</span>.</p></li>
<li><p>Melnet’s PNEt website <a href="https://www.melnet.org.au/pnet/">(link)</a>.</p></li>
</ul>


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-Frank1986" class="csl-entry" role="listitem">
Frank, O, and David Strauss. 1986. <span>“<span class="nocase">Markov graphs</span>.”</span> <em>Journal of the American Statistical Association</em> 81 (395): 832–42. <a href="https://doi.org/10.2307/2289017">https://doi.org/10.2307/2289017</a>.
</div>
<div id="ref-geyerConstrainedMonteCarlo1992" class="csl-entry" role="listitem">
Geyer, Charles J., and Elizabeth A. Thompson. 1992. <span>“Constrained <span>Monte Carlo Maximum Likelihood</span> for <span>Dependent Data</span>.”</span> <em>Journal of the Royal Statistical Society. Series B (Methodological)</em> 54 (3): 657–99. <a href="https://www.jstor.org/stable/2345852">https://www.jstor.org/stable/2345852</a>.
</div>
<div id="ref-Holland1981" class="csl-entry" role="listitem">
Holland, Paul W., and Samuel Leinhardt. 1981. <span>“<span class="nocase">An exponential family of probability distributions for directed graphs</span>.”</span> <em>Journal of the American Statistical Association</em> 76 (373): 33–50. <a href="https://doi.org/10.2307/2287037">https://doi.org/10.2307/2287037</a>.
</div>
<div id="ref-hunterCurvedExponentialFamily2007" class="csl-entry" role="listitem">
Hunter, David R. 2007. <span>“Curved Exponential Family Models for Social Networks.”</span> <em>Social Networks</em> 29 (2): 216–30. <a href="https://doi.org/10.1016/j.socnet.2006.08.005">https://doi.org/10.1016/j.socnet.2006.08.005</a>.
</div>
<div id="ref-leifeldTexregConversionStatistical2013" class="csl-entry" role="listitem">
Leifeld, Philip. 2013. <span>“<span><strong>Texreg</strong></span> : <span>Conversion</span> of <span>Statistical Model Output</span> in <span><em>R</em></span> to <span>L A T E X</span> and <span>HTML Tables</span>.”</span> <em>Journal of Statistical Software</em> 55 (8). <a href="https://doi.org/10.18637/jss.v055.i08">https://doi.org/10.18637/jss.v055.i08</a>.
</div>
<div id="ref-lusherExponentialRandomGraph2013" class="csl-entry" role="listitem">
Lusher, Dean, Johan Koskinen, and Garry Robins. 2013. <em>Exponential <span>Random Graph Models</span> for <span>Social Networks</span>: <span>Theory</span>, <span>Methods</span>, and <span>Applications</span></em>. <span>Cambridge University Press</span>.
</div>
<div id="ref-Robins2007" class="csl-entry" role="listitem">
Robins, Garry, Pip Pattison, Yuval Kalish, and Dean Lusher. 2007. <span>“<span class="nocase">An introduction to exponential random graph (p*) models for social networks</span>.”</span> <em>Social Networks</em> 29 (2): 173–91. <a href="https://doi.org/10.1016/j.socnet.2006.08.002">https://doi.org/10.1016/j.socnet.2006.08.002</a>.
</div>
<div id="ref-Snijders2006" class="csl-entry" role="listitem">
Snijders, Tom A B, Philippa E Pattison, Garry L Robins, and Mark S Handcock. 2006. <span>“<span class="nocase">New specifications for exponential random graph models</span>.”</span> <em>Sociological Methodology</em> 36 (1): 99–153. <a href="https://doi.org/10.1111/j.1467-9531.2006.00176.x">https://doi.org/10.1111/j.1467-9531.2006.00176.x</a>.
</div>
<div id="ref-vegayonExponentialRandomGraph2021" class="csl-entry" role="listitem">
Vega Yon, George G., Andrew Slaughter, and Kayla de la Haye. 2021. <span>“Exponential Random Graph Models for Little Networks.”</span> <em>Social Networks</em> 64 (August 2020): 225–38. <a href="https://doi.org/10.1016/j.socnet.2020.07.005">https://doi.org/10.1016/j.socnet.2020.07.005</a>.
</div>
<div id="ref-Wasserman1996" class="csl-entry" role="listitem">
Wasserman, Stanley, and Philippa Pattison. 1996. <span>“<span class="nocase">Logit models and logistic regressions for social networks: I. An introduction to Markov graphs and p*</span>.”</span> <em>Psychometrika</em> 61 (3): 401–25. <a href="https://doi.org/10.1007/BF02294547">https://doi.org/10.1007/BF02294547</a>.
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>While ERG Models can be used to predict individual ties (which is another way of describing them), the focus is on the processes that give origin to the network.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./04-lab-1.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Lab 1</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./06-ergms-cont.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Convergence on ERGMs</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">Statistical Inference in Network Science - <a href="https://ggvy.cl" target="_blank">https://ggvy.cl</a></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>